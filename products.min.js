!function(){var e=JSON.parse(localStorage.getItem("casaroCart"))||[];function t(){localStorage.setItem("casaroCart",JSON.stringify(e))}var a=[{id:1,name:"X\xe1m",code:"#878377",folder:"1"},{id:2,name:"Đen",code:"#121212",folder:"2"},{id:3,name:"Trắng kem",code:"#fff6da",folder:"3"},{id:4,name:"Đỏ",code:"#901923",folder:"4"},{id:5,name:"N\xe2u",code:"#5e4230",folder:"5"},{id:6,name:"Xanh navy",code:"#394668",folder:"6"},{id:7,name:"Xanh l\xe1 đậm",code:"#265c51",folder:"7"},{id:8,name:"Xanh ngọc",code:"#0f9b8e",folder:"8"}],i=[{size:"80cm x 1m85",original:1689e3,sale:1299e3},{size:"1m x 1m85",original:1949e3,sale:1499e3},{size:"1m2 x 1m85",original:2209e3,sale:1699e3},{size:"1m5 x 1m85",original:2599e3,sale:1999e3}],n=[];a.forEach(function(e){n.push({id:"sofa-"+e.id,type:"sofa",name:"Sofa Gấp Gọn Đa Năng",color:e.name,colorCode:e.code,folder:e.folder,description:"Chất liệu vải cao cấp, khung sườn chắc chắn chịu lực, thiết kế th\xf4ng minh tiết kiệm diện t\xedch. Ph\xf9 hợp mọi kh\xf4ng gian nh\xe0 ở sang trọng.",originalPrice:1689e3,salePrice:1299e3,discount:23,sizes:i,gift:"Tặng k\xe8m 2 gối tựa",image:"assets/images/sofagapgon/"+e.folder+".1.jpg"})}),a.forEach(function(e){n.push({id:"pillow-"+e.id,type:"pillow",name:"Gối Tựa Lẻ",color:e.name,colorCode:e.code,folder:e.folder,description:"Gối tựa cao cấp, chất liệu vải mềm mại, đ\xe0n hồi tốt. Ph\xf9 hợp kết hợp với sofa hoặc sử dụng ri\xeang.",originalPrice:159e3,salePrice:95400,discount:40,sizes:null,gift:null,image:"assets/images/sofagapgon/"+e.folder+".5.jpg",isPillow:!0})});var s=document.getElementById("productsGrid"),l=document.querySelectorAll(".filter-btn"),r=document.getElementById("productModal"),c=document.getElementById("productModalOverlay"),o=document.getElementById("productModalClose"),d=document.getElementById("modalMainImg"),m=document.getElementById("modalThumbs"),g=document.getElementById("modalBadge"),u=document.getElementById("modalTitle"),v=document.getElementById("modalDesc"),f=document.getElementById("modalPriceOriginal"),y=document.getElementById("modalPriceSale"),p=document.getElementById("modalDiscount"),$=document.getElementById("modalSizeOption"),E=document.getElementById("modalSizeOptions"),h=document.getElementById("modalLegsOption"),L=document.getElementById("modalLegsOptions"),B=document.getElementById("modalOrderBtn"),_=document.getElementById("modalCartBtn"),I=document.getElementById("orderModal"),k=document.getElementById("orderModalOverlay"),b=document.getElementById("orderModalClose"),x=document.getElementById("orderForm"),C=document.getElementById("orderSummary"),P=document.getElementById("submitOrderBtn"),z=document.getElementById("successModal"),M=document.getElementById("successModalOverlay"),w=document.getElementById("successMessage"),S=document.getElementById("successContinue"),O=document.getElementById("cartSidebar"),T=document.getElementById("cartOverlay"),q=document.getElementById("cartClose"),G=document.getElementById("cartBody"),H=document.getElementById("cartFooter"),A=document.getElementById("cartEmpty"),X=document.getElementById("cartTotalPrice"),j=document.querySelector(".cart-count"),N=document.getElementById("cartBtn"),V=document.getElementById("cartCheckoutBtn"),D=document.getElementById("continueShopping"),F=null,Y=null,J={legs:4,extra:0};function K(e){return e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,".")+"đ"}function Q(){return e.reduce(function(e,t){return e+t.salePrice*t.quantity},0)}function R(){var a=e.reduce(function(e,t){return e+t.quantity},0);j.textContent=a,0===e.length?(A.style.display="flex",G.style.display="none",H.style.display="none"):(A.style.display="none",G.style.display="block",H.style.display="block",G.innerHTML=e.map(function(e){var t=e.color;return e.size&&(t+=" / "+e.size),e.legs&&(t+=" / "+e.legs+" ch\xe2n"),'<div class="cart-item" data-id="'+e.id+'"><img src="'+e.image+'" alt="'+e.name+'" class="cart-item-img"><div class="cart-item-info"><h4 class="cart-item-name">'+e.name+'</h4><p class="cart-item-variant">'+t+'</p><p class="cart-item-price">'+K(e.salePrice)+'</p></div><button type="button" class="cart-item-remove" data-id="'+e.id+'" aria-label="X\xf3a"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M3 6h18M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/></svg></button></div>'}).join(""),G.querySelectorAll(".cart-item-remove").forEach(function(a){a.addEventListener("click",function(){var a;a=this.dataset.id,e=e.filter(function(e){return e.id!==a}),t(),R()})})),X.textContent=K(Q())}function U(){O.classList.add("active"),document.body.style.overflow="hidden"}function W(){O.classList.remove("active"),document.body.style.overflow=""}function Z(e){var t=n;e&&"all"!==e&&(t=n.filter(function(t){return t.type===e})),s.innerHTML=t.map(function(e){var t=e.gift?'<div class="product-card-gift"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M20 12v10H4V12M2 7h20v5H2zM12 22V7M12 7H7.5a2.5 2.5 0 0 1 0-5C11 2 12 7 12 7zM12 7h4.5a2.5 2.5 0 0 0 0-5C13 2 12 7 12 7z"/></svg>'+e.gift+"</div>":"";return'<div class="product-card" data-id="'+e.id+'"><div class="product-card-image"><img src="'+e.image+'" alt="'+e.name+" - "+e.color+'"><span class="product-card-badge">Giảm '+e.discount+"%</span>"+t+'</div><div class="product-card-info"><p class="product-card-category">'+("sofa"===e.type?"Ghế Sofa":"Gối")+'</p><h3 class="product-card-title">'+e.name+'</h3><p class="product-card-color">M\xe0u: '+e.color+'</p><div class="product-card-price"><span class="product-card-price-original">'+K(e.originalPrice)+'</span><span class="product-card-price-sale">'+K(e.salePrice)+"</span></div></div></div>"}).join(""),s.querySelectorAll(".product-card").forEach(function(e){e.addEventListener("click",function(){var e=this.dataset.id,t=n.find(function(t){return t.id===e});t&&function e(t){if(F=t,Y=t.sizes?t.sizes[0]:null,g.textContent=t.gift||"",u.textContent=t.name+" - M\xe0u "+t.color,v.textContent=t.description,ee(),d.src=t.image,d.alt=t.name,m.innerHTML="",t.isPillow){var a=document.createElement("img");a.src="assets/images/sofagapgon/"+t.folder+".5.jpg",a.alt=t.name+" - "+t.color,a.classList.add("active"),m.appendChild(a)}else for(var i=1;i<=4;i++){var a=document.createElement("img");a.src="assets/images/sofagapgon/"+t.folder+"."+i+".jpg",a.alt=t.name+" - G\xf3c "+i,1===i&&a.classList.add("active"),m.appendChild(a)}var n=m.querySelectorAll("img");if(n.forEach(function(e){e.addEventListener("click",function(){n.forEach(function(e){e.classList.remove("active")}),this.classList.add("active"),d.src=this.src})}),t.sizes){$.style.display="block",E.innerHTML=t.sizes.map(function(e,t){return'<button type="button" class="modal-size-btn'+(0===t?" active":"")+'" data-original="'+e.original+'" data-sale="'+e.sale+'">'+e.size+"</button>"}).join("");var s=E.querySelectorAll(".modal-size-btn");s.forEach(function(e){e.addEventListener("click",function(){s.forEach(function(e){e.classList.remove("active")}),this.classList.add("active"),Y={size:this.textContent,original:parseInt(this.dataset.original),sale:parseInt(this.dataset.sale)},ee()})})}else $.style.display="none";if("sofa"===t.type){h.style.display="block",J={legs:4,extra:0};var l=L.querySelectorAll(".modal-legs-btn");l.forEach(function(e,t){e.classList.toggle("active",0===t)}),l.forEach(function(e){e.addEventListener("click",function(){l.forEach(function(e){e.classList.remove("active")}),this.classList.add("active"),J={legs:parseInt(this.dataset.legs),extra:parseInt(this.dataset.extra)},ee()})})}else h.style.display="none",J={legs:0,extra:0};r.classList.add("active"),document.body.style.overflow="hidden"}(t)})})}function ee(){var e=Y?Y.original:F.originalPrice,t=Y?Y.sale:F.salePrice;J&&J.extra>0&&(e+=J.extra,t+=J.extra);var a=Math.round((1-(Y?Y.sale:F.salePrice)/(Y?Y.original:F.originalPrice))*100);f.textContent=K(e),y.textContent=K(t),p.textContent="Giảm "+a+"%"}function et(){r.classList.remove("active"),document.body.style.overflow=""}function ea(t){var a,i=[],n=0;if(t&&e.length>0)i=e,n=Q();else if(F){n=(Y?Y.sale:F.salePrice)+(J?J.extra:0),i=[{name:F.name,color:F.color,size:Y?Y.size:null,legs:J&&"sofa"===F.type?J.legs:null,salePrice:n,gift:F.gift}]}C.innerHTML='<div class="summary-title">Đơn h\xe0ng của bạn</div>'+i.map(function(e){var t="M\xe0u "+e.color;return e.size&&(t+=" - "+e.size),e.legs&&(t+=" - "+e.legs+" ch\xe2n"),'<div class="summary-item"><span class="summary-item-name">'+e.name+'</span><span class="summary-item-variant">'+t+'</span><span class="summary-item-price">'+K(e.salePrice)+"</span></div>"+(e.gift?'<div class="summary-item"><span class="summary-item-variant" style="color:#c5a059;">\uD83C\uDF81 '+e.gift+"</span></div>":"")}).join("")+'<div class="summary-total"><span>Tổng cộng:</span><span>'+K(n)+"</span></div>",et(),W(),I.classList.add("active"),document.body.style.overflow="hidden"}function ei(){I.classList.remove("active"),document.body.style.overflow="",x.reset(),P.classList.remove("loading")}function en(){z.classList.remove("active"),document.body.style.overflow=""}l.forEach(function(e){e.addEventListener("click",function(){l.forEach(function(e){e.classList.remove("active")}),this.classList.add("active"),Z(this.dataset.filter)})}),o.addEventListener("click",et),c.addEventListener("click",et),B.addEventListener("click",function(){ea(!1)}),_.addEventListener("click",function a(){var i=Y?Y.sale:F.salePrice,n=J?J.extra:0,s={id:Date.now().toString(36)+Math.random().toString(36).slice(2),productId:F.id,name:F.name,type:F.type,size:Y?Y.size:null,color:F.color,colorCode:F.folder,legs:J&&"sofa"===F.type?J.legs:null,legsExtra:n,originalPrice:(Y?Y.original:F.originalPrice)+n,salePrice:i+n,image:F.image,gift:F.gift,quantity:1};e.push(s),t(),R(),et(),U()}),N.addEventListener("click",U),q.addEventListener("click",W),T.addEventListener("click",W),D.addEventListener("click",W),V.addEventListener("click",function(){e.length>0&&ea(!0)}),b.addEventListener("click",ei),k.addEventListener("click",ei),x.addEventListener("submit",function a(i){i.preventDefault();var n={name:document.getElementById("orderName").value,phone:document.getElementById("orderPhone").value,address:document.getElementById("orderAddress").value,items:e.length>0?e:[F],total:e.length>0?Q():(Y?Y.sale:F.salePrice)+(J?J.extra:0)};P.classList.add("loading"),setTimeout(function(){var a;console.log("Order submitted:",n),ei(),a=n.name,w.textContent="Cảm ơn "+(a||"bạn")+". Casaro Sofa sẽ li\xean hệ lại với bạn ngay để x\xe1c nhận đơn h\xe0ng.",z.classList.add("active"),e=[],t(),R()},1500)}),M.addEventListener("click",en),S.addEventListener("click",en),document.addEventListener("keydown",function(e){"Escape"===e.key&&(et(),ei(),en(),W())});var es=document.getElementById("luxuryHeader");window.addEventListener("scroll",function(){window.pageYOffset>50?es.classList.add("scrolled"):es.classList.remove("scrolled")});var el=document.getElementById("menuToggle"),er=document.getElementById("mainNav"),ec=document.getElementById("navClose"),eo=document.getElementById("navOverlay");function ed(){el.classList.remove("active"),er.classList.remove("active"),document.body.classList.remove("menu-open")}el.addEventListener("click",function(){el.classList.toggle("active"),er.classList.toggle("active"),document.body.classList.toggle("menu-open")}),ec.addEventListener("click",ed),eo.addEventListener("click",ed),er.querySelectorAll(".nav-link").forEach(function(e){e.addEventListener("click",ed)}),Z("all"),R()}();
